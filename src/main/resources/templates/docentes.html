<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout('√Årea Administrativa', ~{::section})}">
<section>
    <!-- BANNER ANIMADO REDUCIDO -->
    <div class="banner-admin-compacto">
        <canvas id="particles-admin"></canvas>
        <div class="ondas-container">
            <div class="onda onda-1"></div>
            <div class="onda onda-2"></div>
            <div class="onda onda-3"></div>
            <div class="onda onda-4"></div>
        </div>
        <div class="luz-brillante"></div>

        <div class="contenido-admin-compacto">
            <div class="icono-admin-container">
                <div class="icono-admin">üë®‚Äçüè´</div>
                <div class="anillos-icono"></div>
            </div>
            <h1 class="titulo-admin-compacto">√Årea Administrativa</h1>
            <p class="subtitulo-admin-compacto">Nuestro Equipo de Profesores</p>
            <div class="linea-neon-compacto">
                <div class="punto-luz"></div>
            </div>
        </div>
    </div>

    <!-- Mensajes de √©xito/error -->
    <div th:if="${param.exito}" style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin: 20px auto; max-width: 800px; text-align: center;">
        ‚úÖ <strong>¬°Docente guardado exitosamente!</strong>
    </div>
    <div th:if="${param.eliminado}" style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin: 20px auto; max-width: 800px; text-align: center;">
        ‚úÖ <strong>¬°Docente eliminado exitosamente!</strong>
    </div>
    <div th:if="${param.error}" style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px; margin: 20px auto; max-width: 800px; text-align: center;">
        ‚ùå <strong>Error al procesar la solicitud</strong>
    </div>

    <!-- Mensaje de error de conexi√≥n -->
    <div th:if="${errorConexion}" style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px; margin: 20px auto; max-width: 800px; text-align: center;">
        <strong>‚ö†Ô∏è <span th:text="${errorConexion}"></span></strong>
    </div>

    <!-- Botones -->
    <div style="text-align: center; margin-bottom: 20px;">
        <a th:href="@{/docentes}" style="background: #003366; color: white; padding: 12px 25px; text-decoration: none; border-radius: 5px; display: inline-block; margin: 5px; font-weight: bold;">
            üìã Ver Docentes
        </a>
        <button onclick="mostrarLoginDocente()" style="background: #ffd700; color: #003366; padding: 12px 25px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1em; margin: 5px;">
            ‚ûï Registrar Nuevo Docente
        </button>
    </div>

    <!-- Login Admin -->
    <div id="loginDocente" style="display: none; max-width: 400px; margin: 20px auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
        <h3 style="color: #003366; text-align: center; margin-bottom: 20px;">üîí Acceso Restringido</h3>
        <input type="text" id="usuarioDocente" placeholder="Usuario" style="width: 100%; padding: 10px; margin-bottom: 10px; border: 2px solid #003366; border-radius: 5px;">
        <input type="password" id="passwordDocente" placeholder="Contrase√±a" style="width: 100%; padding: 10px; margin-bottom: 15px; border: 2px solid #003366; border-radius: 5px;">
        <div style="display: flex; gap: 10px;">
            <button onclick="verificarDocente()" style="flex: 1; background: #003366; color: white; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">Ingresar</button>
            <button onclick="cancelarLoginDocente()" style="flex: 1; background: #666; color: white; padding: 12px; border: none; border-radius: 5px; cursor: pointer;">Cancelar</button>
        </div>
        <p id="errorLoginDocente" style="color: red; text-align: center; margin-top: 10px; display: none;">‚ùå Credenciales incorrectas</p>
    </div>

    <!-- Buscador -->
    <div style="margin-bottom: 20px; text-align: center;">
        <form th:action="@{/docentes}" method="get" style="display: inline-flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
            <input type="text" name="busqueda" th:value="${param.busqueda}" placeholder="Buscar docente o √Årea..." style="padding: 10px; border: 2px solid #003366; border-radius: 25px; font-size: 14px; outline: none; min-width: 250px;">
            <button type="submit" style="background: #003366; color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer;">Buscar</button>
            <a th:href="@{/docentes}" style="background: #666; color: white; padding: 10px 20px; border-radius: 25px; text-decoration: none;">Limpiar</a>
        </form>
    </div>

    <!-- MENSAJE SI NO HAY DOCENTES -->
    <div th:if="${#lists.isEmpty(docentes)}" style="text-align: center; padding: 40px; color: #666; background: white; border-radius: 10px; margin: 20px auto; max-width: 600px;">
        <div style="font-size: 4em; margin-bottom: 20px;">üë§</div>
        <h3 style="color: #003366; margin-bottom: 10px;">No hay docentes registrados</h3>
        <p>A√∫n no se han agregado docentes al sistema.</p>
    </div>

    <!-- Grid de Docentes Compacto -->
    <div class="docentes-grid-compacto" th:if="${!#lists.isEmpty(docentes)}">
        <div class="flip-card-profesor" th:each="docente : ${docentes}">
            <div class="flip-card-inner-profesor">

                <!-- FRENTE -->
                <div class="flip-card-front-profesor">
                    <div class="profesor-imagen">
                        <img th:if="${docente.fotoUrl}" th:src="@{'http://localhost:8081' + ${docente.fotoUrl}}" alt="Profesor">
                        <div th:unless="${docente.fotoUrl}" class="placeholder-profesor">üë§</div>
                    </div>
                    <div class="profesor-info-front">
                        <h3 th:text="${docente.nombre}">Nombre Docente</h3>
                        <p class="area-front" th:text="${docente.area}">√Årea</p>
                        <div class="orden-badge" th:if="${docente.orden != null}" th:text="'#' + ${docente.orden}">#1</div>
                    </div>
                </div>

                <!-- REVERSO -->
                <div class="flip-card-back-profesor">
                    <h3 th:text="${docente.nombre}" style="color: #003366; margin-bottom: 10px; font-size: 1.1em;">Nombre</h3>
                    <p class="especialidad-back" th:text="${docente.especialidad}">Especialidad</p>

                    <div class="detalle-back">
                        <p><strong>üìß Email:</strong> <span th:text="${docente.email}">email</span></p>
                        <p><strong>üì± Tel√©fono:</strong> <span th:text="${docente.telefono}">tel</span></p>
                        <p><strong>‚≠ê Exp:</strong> <span th:text="${docente.experienciaAnios} + ' a√±os'">exp</span></p>
                    </div>

                    <!-- BOT√ìN ELIMINAR - AHORA DENTRO DEL LOOP th:each -->
                    <a th:href="@{/docentes/eliminar/{id}(id=${docente.id})}"
                       style="display: inline-block; padding: 8px 15px; background: #dc3545; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; font-size: 0.85em; margin-top: 10px;">
                        üóëÔ∏è Eliminar
                    </a>
                </div>

            </div>
        </div>
    </div>

    <style>
        /* ===== BANNER COMPACTO ===== */
        .banner-admin-compacto {
            position: relative;
            width: 100%;
            height: 280px;
            background: linear-gradient(135deg, #001a33 0%, #003366 50%, #004488 100%);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 51, 102, 0.4);
        }

        #particles-admin {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .ondas-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            overflow: hidden;
        }

        .onda {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 200%;
            background: transparent;
            border-radius: 40%;
            opacity: 0.3;
        }

        .onda-1 {
            background: rgba(255, 215, 0, 0.1);
            animation: rotarOnda 20s linear infinite;
            bottom: -150%;
        }

        .onda-2 {
            background: rgba(0, 102, 204, 0.2);
            animation: rotarOnda 25s linear infinite reverse;
            bottom: -140%;
            left: -50%;
        }

        .onda-3 {
            background: rgba(255, 215, 0, 0.15);
            animation: rotarOnda 30s linear infinite;
            bottom: -160%;
            left: 25%;
        }

        .onda-4 {
            background: rgba(0, 200, 255, 0.1);
            animation: rotarOnda 35s linear infinite reverse;
            bottom: -155%;
            left: -25%;
        }

        @keyframes rotarOnda {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .luz-brillante {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255,215,0,0.2) 0%, transparent 70%);
            z-index: 2;
            animation: pulsarLuz 4s ease-in-out infinite;
        }

        @keyframes pulsarLuz {
            0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.1); }
        }

        .contenido-admin-compacto {
            position: relative;
            z-index: 10;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            padding: 20px;
        }

        .icono-admin-container {
            position: relative;
            margin-bottom: 10px;
        }

        .icono-admin {
            font-size: 3em;
            position: relative;
            z-index: 2;
            animation: flotarIcono 3s ease-in-out infinite;
        }

        .anillos-icono {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 50%;
            animation: expandirAnillo 2s ease-out infinite;
        }

        .anillos-icono::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            animation: expandirAnillo 2s ease-out 0.5s infinite;
        }

        @keyframes flotarIcono {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes expandirAnillo {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; }
        }

        .titulo-admin-compacto {
            font-size: 2.5em;
            margin: 0 0 10px 0;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            animation: aparecerTexto 0.8s ease-out;
        }

        .subtitulo-admin-compacto {
            font-size: 1.1em;
            margin: 0;
            opacity: 0.9;
            animation: aparecerTexto 0.8s ease-out 0.3s both;
        }

        @keyframes aparecerTexto {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .linea-neon-compacto {
            width: 200px;
            height: 3px;
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
            position: relative;
            overflow: hidden;
            margin-top: 15px;
        }

        .punto-luz {
            position: absolute;
            top: 50%;
            left: -10px;
            width: 20px;
            height: 20px;
            background: #ffd700;
            border-radius: 50%;
            transform: translateY(-50%);
            box-shadow: 0 0 20px #ffd700, 0 0 40px #ffd700;
            animation: moverLuz 3s linear infinite;
        }

        @keyframes moverLuz {
            0% { left: -10px; }
            100% { left: 100%; }
        }

        /* ===== GRID DE DOCENTES COMPACTO ===== */
        .docentes-grid-compacto {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 30px;
            padding: 0 10px;
        }

        .flip-card-profesor {
            background-color: transparent;
            width: 100%;
            height: 320px;
            perspective: 1000px;
            cursor: pointer;
        }

        .flip-card-inner-profesor {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 15px;
        }

        .flip-card-profesor:hover .flip-card-inner-profesor {
            transform: rotateY(180deg);
        }

        .flip-card-front-profesor, .flip-card-back-profesor {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 15px;
            overflow: hidden;
        }

        .flip-card-front-profesor {
            background-color: white;
            display: flex;
            flex-direction: column;
        }

        .profesor-imagen {
            width: 100%;
            height: 220px;
            overflow: hidden;
            position: relative;
        }

        .profesor-imagen img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .flip-card-profesor:hover .profesor-imagen img {
            transform: scale(1.1);
        }

        .placeholder-profesor {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #003366 0%, #004488 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 5em;
        }

        .profesor-info-front {
            padding: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .profesor-info-front h3 {
            color: #003366;
            margin: 0 0 8px 0;
            font-size: 1.1em;
        }

        .area-front {
            color: #666;
            font-size: 0.9em;
            margin: 0;
        }

        .orden-badge {
            position: absolute;
            top: -210px;
            right: 10px;
            background: #ffd700;
            color: #003366;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1em;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .flip-card-back-profesor {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            color: #333;
            transform: rotateY(180deg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            border-left: 5px solid #003366;
        }

        [data-theme="dark"] .flip-card-back-profesor {
            background: linear-gradient(135deg, #16213e 0%, #1a1a2e 100%);
            color: #eaeaea;
            border-left-color: #ffd700;
        }

        .especialidad-back {
            color: #003366;
            font-weight: bold;
            font-size: 0.95em;
            margin-bottom: 15px;
            font-style: italic;
        }

        .detalle-back {
            background: #f0f4f8;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            width: 100%;
            text-align: left;
            font-size: 0.85em;
        }

        [data-theme="dark"] .detalle-back {
            background: #0f3460;
        }

        .detalle-back p {
            margin: 8px 0;
            color: #555;
        }

        [data-theme="dark"] .detalle-back p {
            color: #eaeaea;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .banner-admin-compacto {
                height: 250px;
            }
            .titulo-admin-compacto {
                font-size: 1.8em;
            }
            .docentes-grid-compacto {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <script>
        /* ===== PART√çCULAS ===== */
        const canvasAdmin = document.getElementById('particles-admin');
        const ctxAdmin = canvasAdmin.getContext('2d');

        canvasAdmin.width = canvasAdmin.offsetWidth;
        canvasAdmin.height = canvasAdmin.offsetHeight;

        const particulasAdmin = [];
        const numParticulas = 40;

        class ParticulaAdmin {
            constructor() {
                this.x = Math.random() * canvasAdmin.width;
                this.y = Math.random() * canvasAdmin.height;
                this.size = Math.random() * 2 + 1;
                this.speedX = (Math.random() - 0.5) * 0.5;
                this.speedY = (Math.random() - 0.5) * 0.5;
                this.color = Math.random() > 0.5 ? '#ffd700' : '#00ccff';
            }

            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.x > canvasAdmin.width) this.x = 0;
                if (this.x < 0) this.x = canvasAdmin.width;
                if (this.y > canvasAdmin.height) this.y = 0;
                if (this.y < 0) this.y = canvasAdmin.height;
            }

            draw() {
                ctxAdmin.fillStyle = this.color;
                ctxAdmin.shadowBlur = 10;
                ctxAdmin.shadowColor = this.color;
                ctxAdmin.beginPath();
                ctxAdmin.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctxAdmin.fill();
                ctxAdmin.shadowBlur = 0;
            }
        }

        function initParticulasAdmin() {
            for (let i = 0; i < numParticulas; i++) {
                particulasAdmin.push(new ParticulaAdmin());
            }
        }

        function animarParticulasAdmin() {
            ctxAdmin.clearRect(0, 0, canvasAdmin.width, canvasAdmin.height);

            for (let p of particulasAdmin) {
                p.update();
                p.draw();
            }

            for (let i = 0; i < particulasAdmin.length; i++) {
                for (let j = i + 1; j < particulasAdmin.length; j++) {
                    const dx = particulasAdmin[i].x - particulasAdmin[j].x;
                    const dy = particulasAdmin[i].y - particulasAdmin[j].y;
                    const dist = Math.sqrt(dx * dx + dy * dy);

                    if (dist < 100) {
                        ctxAdmin.beginPath();
                        ctxAdmin.strokeStyle = `rgba(255, 215, 0, ${0.2 * (1 - dist/100)})`;
                        ctxAdmin.lineWidth = 1;
                        ctxAdmin.moveTo(particulasAdmin[i].x, particulasAdmin[i].y);
                        ctxAdmin.lineTo(particulasAdmin[j].x, particulasAdmin[j].y);
                        ctxAdmin.stroke();
                    }
                }
            }

            requestAnimationFrame(animarParticulasAdmin);
        }

        initParticulasAdmin();
        animarParticulasAdmin();

        window.addEventListener('resize', () => {
            canvasAdmin.width = canvasAdmin.offsetWidth;
            canvasAdmin.height = canvasAdmin.offsetHeight;
        });

        /* ===== FUNCIONES LOGIN ===== */
        function mostrarLoginDocente() {
            document.getElementById('loginDocente').style.display = 'block';
            document.getElementById('errorLoginDocente').style.display = 'none';
        }

        function cancelarLoginDocente() {
            document.getElementById('loginDocente').style.display = 'none';
        }

        function verificarDocente() {
            const user = document.getElementById('usuarioDocente').value;
            const pass = document.getElementById('passwordDocente').value;

            if (user === 'Admin' && pass === '2026') {
                window.location.href = '/docentes/nuevo';
            } else {
                document.getElementById('errorLoginDocente').style.display = 'block';
            }
        }
    </script>
</section>
</html>